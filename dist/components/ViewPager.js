Object.defineProperty(exports,"__esModule",{value:true});var _jsxFileName='src/components/ViewPager.js';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=require('react');var _react2=_interopRequireDefault(_react);var _reactNative=require('react-native');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var babelPluginFlowReactPropTypes_proptype_ReactElement=require('react').babelPluginFlowReactPropTypes_proptype_ReactElement||require('prop-types').any;var styles=_reactNative.StyleSheet.create({container:{flex:1},scrollView:{flex:1,backgroundColor:'transparent'},card:{backgroundColor:'transparent'}});var defaultProps={bounces:true,style:null,onSelectedIndexChange:function onSelectedIndexChange(){}};var ViewPager=function(_Component){_inherits(ViewPager,_Component);function ViewPager(props){_classCallCheck(this,ViewPager);var _this=_possibleConstructorReturn(this,(ViewPager.__proto__||Object.getPrototypeOf(ViewPager)).call(this,props));_this.state={width:0,height:0,selectedIndex:_this.props.selectedIndex,initialSelectedIndex:_this.props.selectedIndex,scrollingTo:null};_this.handleHorizontalScroll=_this.handleHorizontalScroll.bind(_this);_this.adjustCardSize=_this.adjustCardSize.bind(_this);return _this;}_createClass(ViewPager,[{key:'componentWillReceiveProps',value:function componentWillReceiveProps(nextProps){if(nextProps.selectedIndex!==this.state.selectedIndex){if(_reactNative.Platform.OS==='ios'){this.setState({scrollingTo:nextProps.selectedIndex});}else{this.scrollView.setPage(nextProps.selectedIndex);this.setState({selectedIndex:nextProps.selectedIndex});}}}},{key:'adjustCardSize',value:function adjustCardSize(e){this.setState({width:e.nativeEvent.layout.width,height:e.nativeEvent.layout.height});}},{key:'handleHorizontalScroll',value:function handleHorizontalScroll(e){var selectedIndex=e.nativeEvent.position;if(selectedIndex===undefined){selectedIndex=Math.round(e.nativeEvent.contentOffset.x/this.state.width);}if(selectedIndex<0||selectedIndex>=this.props.count){return;}if(this.state.scrollingTo!==null&&this.state.scrollingTo!==selectedIndex){return;}if(this.props.selectedIndex!==selectedIndex||this.state.scrollingTo!==null){this.setState({selectedIndex:selectedIndex,scrollingTo:null});this.props.onSelectedIndexChange(selectedIndex);}}},{key:'renderContent',value:function renderContent(){var _state=this.state,width=_state.width,height=_state.height;var style=_reactNative.Platform.OS==='ios'&&styles.card;return _react2.default.Children.map(this.props.children,function(child,i){return _react2.default.createElement(_reactNative.View,{style:[style,{width:width,height:height}],key:'r_'+i,__source:{fileName:_jsxFileName,lineNumber:117}},child);});}},{key:'renderIOS',value:function renderIOS(){var _this2=this;return _react2.default.createElement(_reactNative.ScrollView,{ref:function ref(scrollView){_this2.scrollView=scrollView;},contentOffset:{x:this.state.width*this.state.initialSelectedIndex,y:0},style:[styles.scrollView,this.props.style],horizontal:true,pagingEnabled:true,bounces:!!this.props.bounces,scrollsToTop:false,onScroll:this.handleHorizontalScroll,scrollEventThrottle:100,automaticallyAdjustContentInsets:false,directionalLockEnabled:true,showsHorizontalScrollIndicator:false,showsVerticalScrollIndicator:false,onLayout:this.adjustCardSize,__source:{fileName:_jsxFileName,lineNumber:125}},this.renderContent());}},{key:'renderAndroid',value:function renderAndroid(){var _this3=this;return _react2.default.createElement(_reactNative.ViewPagerAndroid,{ref:function ref(scrollView){_this3.scrollView=scrollView;},initialPage:this.state.initialSelectedIndex,onPageSelected:this.handleHorizontalScroll,style:styles.container,__source:{fileName:_jsxFileName,lineNumber:151}},this.renderContent());}},{key:'render',value:function render(){if(_reactNative.Platform.OS==='ios'){return this.renderIOS();}return this.renderAndroid();}}]);return ViewPager;}(_react.Component);ViewPager.defaultProps=defaultProps;ViewPager.propTypes={count:require('prop-types').number.isRequired,selectedIndex:require('prop-types').number.isRequired,onSelectedIndexChange:require('prop-types').func,bounces:require('prop-types').bool,style:require('prop-types').any,children:require('prop-types').any.isRequired};exports.default=ViewPager;